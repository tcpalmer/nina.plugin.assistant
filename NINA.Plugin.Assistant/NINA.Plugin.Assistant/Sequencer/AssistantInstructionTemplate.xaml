<ResourceDictionary
    x:Class="Assistant.NINAPlugin.Sequencer.AssistantInstructionTemplate"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:alt="clr-namespace:NINA.WPF.Base.View;assembly=NINA.WPF.Base"
    xmlns:behaviors="clr-namespace:NINA.Sequencer.Behaviors;assembly=NINA.Sequencer"
    xmlns:converter="clr-namespace:NINA.View.Sequencer.Converter;assembly=NINA.Sequencer"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:local="clr-namespace:Assistant.NINAPlugin.Sequencer"
    xmlns:mini="clr-namespace:NINA.View.Sequencer.MiniSequencer;assembly=NINA.Sequencer"
    xmlns:nina="clr-namespace:NINA.View.Sequencer;assembly=NINA.Sequencer"
    xmlns:ninactrl="clr-namespace:NINACustomControlLibrary;assembly=NINACustomControlLibrary"
    xmlns:ns="clr-namespace:NINA.Core.Locale;assembly=NINA.Core"
    xmlns:rules="clr-namespace:NINA.Core.Utility.ValidationRules;assembly=NINA.Core"
    xmlns:util="clr-namespace:NINA.Core.Utility;assembly=NINA.Core"
    xmlns:view="clr-namespace:NINA.View.Sequencer;assembly=NINA.Sequencer">

    <GeometryGroup x:Key="Assistant.AssistantSVG">
        <PathGeometry Figures="M7.09 43.87h7.11v-1.65c0-2.2 0.44-4.3 1.24-6.22c0.83-1.99 2.04-3.79 3.55-5.29c1.5-1.5 3.3-2.72 5.29-3.55 c1.92-0.8 4.02-1.24 6.22-1.24h28.29l0-0.14V15.65c-0.46-0.17-0.9-0.38-1.32-0.62c-0.59-0.35-1.13-0.77-1.61-1.25 c-0.74-0.74-1.34-1.63-1.75-2.62c-0.39-0.95-0.61-2-0.61-3.08c0-1.09 0.22-2.13 0.61-3.08c0.41-0.99 1.01-1.88 1.75-2.62 c0.74-0.74 1.63-1.34 2.62-1.75c0.95-0.4 2-0.61 3.08-0.61s2.13 0.22 3.08 0.61c0.99 0.41 1.88 1.01 2.62 1.75 c0.74 0.74 1.34 1.63 1.75 2.62c0.39 0.95 0.61 2 0.61 3.08c0 1.09-0.22 2.13-0.61 3.08c-0.41 0.99-1.01 1.88-1.75 2.62l-0.04 0.04 c-0.47 0.46-1 0.87-1.57 1.21c-0.42 0.25-0.86 0.46-1.32 0.62v10.13l0 0.14h28.29c2.2 0 4.3 0.44 6.22 1.24 c2 0.83 3.79 2.04 5.29 3.55c1.5 1.5 2.72 3.3 3.55 5.29c0.8 1.92 1.24 4.02 1.24 6.22v1.65h6.86c0.95 0 1.87 0.19 2.71 0.54 c0.87 0.36 1.65 0.89 2.3 1.54l0.04 0.04c0.64 0.65 1.15 1.41 1.5 2.26c0.35 0.84 0.54 1.75 0.54 2.71v18.92 c0 0.95-0.19 1.87-0.54 2.71c-0.36 0.86-0.89 1.65-1.54 2.3l0 0c-1.28 1.28-3.06 2.08-5.01 2.08h-6.87 c-0.03 2.11-0.47 4.14-1.24 5.99c-0.83 2-2.04 3.79-3.55 5.29c-1.5 1.5-3.3 2.72-5.29 3.55c-1.92 0.8-4.02 1.24-6.22 1.24H30.5 c-2.2 0-4.3-0.44-6.22-1.24c-2-0.83-3.79-2.04-5.29-3.55c-1.5-1.5-2.72-3.3-3.55-5.29c-0.77-1.85-1.21-3.88-1.24-5.99H7.09 c-0.95 0-1.87-0.19-2.71-0.54c-0.87-0.36-1.65-0.89-2.3-1.54l-0.04-0.04c-0.64-0.65-1.15-1.41-1.5-2.26C0.19 71.75 0 70.83 0 69.88 V50.96c0-0.95 0.19-1.87 0.54-2.71c0.36-0.87 0.89-1.65 1.54-2.3l0 0c0.65-0.65 1.43-1.18 2.3-1.54 C5.22 44.06 6.13 43.87 7.09 43.87L7.09 43.87z M47 74.3c-0.14-0.11-0.26-0.23-0.37-0.37c-0.33-0.4-0.5-0.86-0.51-1.33 c-0.01-0.47 0.14-0.94 0.45-1.35c0.11-0.14 0.23-0.27 0.38-0.39c0.52-0.43 1.21-0.66 1.89-0.67c0.68-0.01 1.36 0.19 1.9 0.6 c1.86 1.43 3.7 2.47 5.52 3.16c1.8 0.68 3.58 1 5.34 0.98c1.77-0.02 3.56-0.39 5.39-1.08c1.85-0.7 3.71-1.75 5.6-3.1 c0.56-0.4 1.25-0.58 1.93-0.55c0.68 0.03 1.36 0.27 1.87 0.72c0.13 0.12 0.25 0.25 0.36 0.4c0.3 0.42 0.44 0.9 0.41 1.37 c-0.03 0.47-0.22 0.93-0.56 1.32c-0.12 0.13-0.26 0.26-0.42 0.37c-2.37 1.71-4.75 3.01-7.16 3.9c-2.42 0.89-4.87 1.36-7.35 1.39 c-2.49 0.03-4.95-0.39-7.4-1.28c-2.43-0.88-4.85-2.23-7.23-4.06L47 74.3L47 74.3z M40.77 43.72c0.6 0 1.2 0.06 1.77 0.18 c0.58 0.12 1.15 0.29 1.7 0.52c0.56 0.23 1.09 0.51 1.58 0.84c0.48 0.32 0.93 0.68 1.33 1.08l0.06 0.05 c0.42 0.42 0.8 0.88 1.13 1.38l0.02 0.03c0.32 0.48 0.6 1 0.82 1.55c0.23 0.55 0.4 1.12 0.52 1.7c0.11 0.58 0.18 1.17 0.18 1.77 c0 0.6-0.06 1.2-0.18 1.77c-0.12 0.58-0.29 1.15-0.52 1.71c-0.23 0.56-0.51 1.09-0.84 1.58c-0.34 0.51-0.72 0.97-1.13 1.38 c-0.83 0.83-1.84 1.51-2.97 1.97c-0.55 0.23-1.12 0.4-1.71 0.52c-0.58 0.11-1.17 0.17-1.77 0.17s-1.2-0.06-1.77-0.17 c-0.58-0.12-1.15-0.29-1.71-0.52c-0.56-0.23-1.09-0.51-1.58-0.84c-0.51-0.34-0.97-0.72-1.38-1.13c-0.42-0.42-0.8-0.88-1.13-1.38 l-0.02-0.03c-0.32-0.48-0.6-1-0.82-1.55c-0.23-0.55-0.4-1.12-0.52-1.7c-0.11-0.58-0.17-1.17-0.17-1.77c0-0.6 0.06-1.2 0.17-1.77 c0.12-0.58 0.29-1.15 0.52-1.7c0.23-0.56 0.51-1.09 0.84-1.58c0.34-0.51 0.72-0.97 1.13-1.38c0.42-0.42 0.88-0.8 1.38-1.13 l0.03-0.02c0.48-0.32 1-0.6 1.55-0.82c0.55-0.23 1.12-0.4 1.7-0.52C39.57 43.78 40.17 43.72 40.77 43.72L40.77 43.72z M42.73 48.1 c-0.3-0.12-0.62-0.22-0.95-0.29c-0.32-0.06-0.66-0.1-1.01-0.1c-0.35 0-0.69 0.03-1.01 0.1c-0.34 0.07-0.66 0.16-0.95 0.29 c-0.31 0.13-0.6 0.28-0.88 0.47c-0.27 0.18-0.53 0.4-0.78 0.65c-0.25 0.25-0.46 0.51-0.65 0.78c-0.19 0.28-0.34 0.57-0.47 0.87 c-0.12 0.3-0.22 0.62-0.29 0.95c-0.06 0.32-0.1 0.66-0.1 1.01s0.03 0.69 0.1 1.01c0.07 0.34 0.16 0.66 0.29 0.95 c0.13 0.31 0.28 0.6 0.47 0.87c0.18 0.27 0.4 0.53 0.65 0.78c0.25 0.25 0.51 0.46 0.78 0.65c0.27 0.18 0.57 0.34 0.88 0.47 l0.03 0.02c0.29 0.12 0.59 0.21 0.92 0.27c0.32 0.06 0.66 0.1 1.01 0.1c0.35 0 0.69-0.03 1.01-0.1c0.34-0.07 0.65-0.16 0.95-0.28 c0.31-0.13 0.6-0.29 0.88-0.47c0.27-0.18 0.53-0.4 0.78-0.65c0.25-0.25 0.46-0.51 0.65-0.78c0.19-0.28 0.34-0.57 0.47-0.87 c0.12-0.3 0.22-0.62 0.29-0.95c0.06-0.32 0.1-0.66 0.1-1.01c0-0.35-0.03-0.69-0.1-1.01c-0.07-0.34-0.16-0.66-0.29-0.95 c-0.13-0.31-0.28-0.6-0.47-0.88c-0.19-0.28-0.4-0.54-0.64-0.78l-0.05-0.05c-0.23-0.22-0.47-0.42-0.73-0.59 C43.34 48.38 43.04 48.22 42.73 48.1L42.73 48.1z M82.35 43.72c0.6 0 1.2 0.06 1.77 0.18c0.58 0.12 1.15 0.29 1.7 0.52 c0.56 0.23 1.09 0.51 1.58 0.84c0.47 0.32 0.91 0.67 1.31 1.07c0.02 0.02 0.05 0.04 0.07 0.06c0.42 0.42 0.8 0.88 1.13 1.38 l0.02 0.03c0.32 0.48 0.6 1 0.82 1.55c0.23 0.55 0.4 1.12 0.52 1.7c0.11 0.58 0.17 1.17 0.17 1.77c0 0.6-0.06 1.2-0.17 1.77 c-0.12 0.58-0.29 1.15-0.52 1.71c-0.23 0.56-0.51 1.09-0.84 1.58c-0.34 0.51-0.72 0.97-1.13 1.38c-0.42 0.42-0.88 0.8-1.38 1.13 l-0.03 0.02c-0.49 0.32-1 0.6-1.55 0.82c-0.55 0.23-1.12 0.4-1.71 0.52c-0.58 0.11-1.17 0.17-1.77 0.17c-0.6 0-1.2-0.06-1.77-0.17 c-0.58-0.12-1.15-0.29-1.71-0.52c-0.57-0.24-1.1-0.52-1.58-0.84l-0.05-0.04c-0.48-0.33-0.93-0.69-1.33-1.09 c-0.42-0.42-0.8-0.88-1.13-1.38l-0.02-0.03c-0.32-0.48-0.6-1-0.82-1.55c-0.23-0.55-0.4-1.12-0.52-1.7 c-0.11-0.58-0.18-1.17-0.18-1.77c0-0.6 0.06-1.2 0.18-1.77c0.12-0.58 0.29-1.15 0.52-1.7c0.23-0.56 0.51-1.09 0.84-1.58 c0.34-0.51 0.72-0.97 1.13-1.38c0.41-0.41 0.88-0.79 1.38-1.13c0.49-0.33 1.02-0.61 1.58-0.85c0.55-0.23 1.12-0.4 1.7-0.52 C81.16 43.78 81.75 43.72 82.35 43.72L82.35 43.72z M84.32 48.1c-0.3-0.12-0.62-0.22-0.95-0.29c-0.32-0.06-0.66-0.1-1.01-0.1 c-0.35 0-0.69 0.03-1.01 0.1c-0.34 0.07-0.66 0.16-0.95 0.29c-0.31 0.13-0.6 0.28-0.88 0.47c-0.27 0.18-0.53 0.4-0.78 0.65 c-0.25 0.25-0.46 0.51-0.65 0.78c-0.19 0.28-0.34 0.57-0.47 0.87c-0.12 0.3-0.22 0.62-0.29 0.95c-0.06 0.32-0.1 0.66-0.1 1.01 c0 0.35 0.03 0.69 0.1 1.01c0.07 0.34 0.16 0.66 0.29 0.95c0.13 0.31 0.28 0.6 0.47 0.87c0.18 0.27 0.4 0.53 0.65 0.78 c0.25 0.25 0.51 0.46 0.78 0.65c0.27 0.18 0.57 0.34 0.88 0.47l0.03 0.02c0.29 0.12 0.59 0.21 0.92 0.27 c0.32 0.06 0.66 0.1 1.01 0.1c0.35 0 0.69-0.03 1.01-0.1c0.34-0.07 0.65-0.16 0.95-0.28c0.31-0.13 0.6-0.29 0.88-0.47 c0.28-0.19 0.54-0.4 0.78-0.64v0c0.25-0.25 0.46-0.51 0.65-0.78c0.19-0.28 0.34-0.57 0.47-0.87c0.12-0.3 0.22-0.62 0.29-0.95 c0.06-0.32 0.1-0.66 0.1-1.01c0-0.35-0.03-0.69-0.1-1.01c-0.07-0.34-0.16-0.66-0.29-0.95c-0.13-0.31-0.28-0.6-0.47-0.88 c-0.19-0.28-0.4-0.54-0.64-0.78l-0.05-0.05c-0.23-0.22-0.47-0.42-0.73-0.59C84.92 48.38 84.63 48.22 84.32 48.1L84.32 48.1z M18.19 45.87v30.87c0 1.66 0.33 3.24 0.93 4.69c0.63 1.5 1.54 2.86 2.68 4c1.14 1.14 2.5 2.06 4 2.68 c1.44 0.6 3.03 0.93 4.69 0.93h62.13c1.66 0 3.24-0.33 4.69-0.93c1.5-0.63 2.86-1.54 4-2.68s2.06-2.5 2.68-4 c0.6-1.44 0.93-3.03 0.93-4.69V42.22c0-1.66-0.33-3.25-0.93-4.69c-0.63-1.5-1.54-2.86-2.68-4c-1.14-1.14-2.5-2.06-4-2.68 c-1.44-0.6-3.03-0.93-4.69-0.93H30.5c-1.66 0-3.24 0.33-4.69 0.93c-1.5 0.63-2.86 1.54-4 2.68c-1.14 1.14-2.06 2.5-2.68 4 c-0.6 1.44-0.93 3.03-0.93 4.69V45.87L18.19 45.87z M14.2 47.86H7.09c-0.42 0-0.82 0.08-1.18 0.23c-0.38 0.16-0.72 0.39-1.01 0.68 l-0.04 0.03c-0.27 0.28-0.49 0.61-0.64 0.97c-0.15 0.36-0.23 0.76-0.23 1.18v18.92c0 0.42 0.08 0.82 0.23 1.18 c0.16 0.38 0.39 0.72 0.68 1.01c0.56 0.56 1.33 0.91 2.18 0.91h7.11V47.86L14.2 47.86z M115.79 47.86h-6.86v25.11h6.86 c0.42 0 0.82-0.08 1.18-0.23c0.38-0.16 0.72-0.39 1.01-0.68c0.29-0.29 0.52-0.63 0.68-1.01c0.15-0.36 0.23-0.76 0.23-1.18V50.96 c0-0.42-0.08-0.82-0.23-1.18c-0.16-0.38-0.39-0.72-0.68-1.01l0 0c-0.29-0.29-0.63-0.52-1.01-0.68 C116.61 47.95 116.21 47.86 115.79 47.86L115.79 47.86z" FillRule="NonZero" />
    </GeometryGroup>

    <Style x:Key="DSOHeaderExpanderStyle" TargetType="ToggleButton">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ToggleButton}">
                    <StackPanel>
                        <Border Height="10" BorderBrush="Transparent" />
                        <Border x:Name="topBorder" BorderBrush="{StaticResource SecondaryBackgroundBrush}">
                            <Grid
                                x:Name="Head"
                                Background="{StaticResource TertiaryBackgroundBrush}"
                                SnapsToDevicePixels="True">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30" />
                                    <ColumnDefinition Width="30" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Path
                                    x:Name="iconarrow"
                                    Grid.Column="0"
                                    Width="10"
                                    Height="10"
                                    Margin="10,0,10,0"
                                    Data="{StaticResource ArrowRightSVG}"
                                    Fill="{StaticResource ButtonForegroundBrush}"
                                    Stretch="Uniform" />
                                <Path
                                    x:Name="icon"
                                    Grid.Column="1"
                                    Width="20"
                                    Height="20"
                                    Data="{StaticResource TelescopeSVG}"
                                    Fill="{StaticResource ButtonForegroundBrush}"
                                    Stretch="Uniform" />
                                <ContentPresenter
                                    Grid.Column="2"
                                    Margin="4,0,0,0"
                                    HorizontalAlignment="Left"
                                    VerticalAlignment="Center"
                                    RecognizesAccessKey="True"
                                    SnapsToDevicePixels="True">
                                    <i:Interaction.Behaviors>
                                        <behaviors:DragDropBehavior />
                                    </i:Interaction.Behaviors>
                                </ContentPresenter>
                            </Grid>
                        </Border>
                    </StackPanel>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsChecked" Value="true">
                            <Setter TargetName="iconarrow" Property="Data" Value="{StaticResource ArrowDownSVG}" />
                            <Setter TargetName="iconarrow" Property="Margin" Value="5,0,10,0" />
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter TargetName="Head" Property="Background" Value="{StaticResource SecondaryBackgroundBrush}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
    <Style x:Key="DSOExpander" TargetType="ninactrl:DetachingExpander">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="ninactrl:DetachingExpander">
                    <Border
                        Background="{TemplateBinding Background}"
                        BorderBrush="{TemplateBinding BorderBrush}"
                        BorderThickness="{TemplateBinding BorderThickness}"
                        Focusable="False"
                        SnapsToDevicePixels="true">
                        <DockPanel>
                            <ToggleButton
                                x:Name="HeaderSite"
                                MinWidth="0"
                                MinHeight="0"
                                Padding="{TemplateBinding Padding}"
                                HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                Content="{TemplateBinding Header}"
                                ContentTemplate="{TemplateBinding HeaderTemplate}"
                                ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                                DockPanel.Dock="Top"
                                FocusVisualStyle="{StaticResource ExpanderHeaderFocusVisual}"
                                FontFamily="{TemplateBinding FontFamily}"
                                FontSize="{TemplateBinding FontSize}"
                                FontStretch="{TemplateBinding FontStretch}"
                                FontStyle="{TemplateBinding FontStyle}"
                                FontWeight="{TemplateBinding FontWeight}"
                                Foreground="{TemplateBinding Foreground}"
                                IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                Style="{StaticResource DSOHeaderExpanderStyle}" />
                            <StackPanel DockPanel.Dock="Bottom">
                                <Border
                                    Height="10"
                                    Margin="0,0,0,0"
                                    HorizontalAlignment="{Binding HorizontalAlignment, RelativeSource={RelativeSource AncestorType=ContentPresenter}, Mode=OneWayToSource}"
                                    Background="Transparent" />
                            </StackPanel>
                            <ContentPresenter
                                x:Name="ExpandSite"
                                Margin="{TemplateBinding Padding}"
                                HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                Focusable="false"
                                Visibility="Collapsed" />
                        </DockPanel>
                        <i:Interaction.Behaviors>
                            <behaviors:DragOverBehavior DragAboveSize="0" DragBelowSize="0" />
                            <behaviors:DropIntoBehavior AllowedDragDropTypesString="NINA.Sequencer.TargetSequenceContainer" OnDropCommand="DropTargetCommand" />
                        </i:Interaction.Behaviors>
                    </Border>
                    <ControlTemplate.Triggers>
                        <Trigger Property="IsExpanded" Value="true">
                            <Setter TargetName="ExpandSite" Property="Visibility" Value="Visible" />
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <DataTemplate DataType="{x:Type local:AssistantInstruction}">
        <view:SequenceContainerView>
            <view:SequenceContainerView.SequenceContainerContent>
                <Border BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,2">
                    <ninactrl:DetachingExpander IsExpanded="{Binding Target.Expanded}" Style="{StaticResource DSOExpander}">
                        <ninactrl:DetachingExpander.Header>
                            <StackPanel Orientation="Horizontal">
                                <Border MinHeight="25">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="{ns:Loc LblTarget}" />
                                </Border>
                                <StackPanel Margin="5,0,0,0" Orientation="Horizontal">
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="{Binding Target.TargetName}" />
                                    <TextBlock
                                        Margin="5,0,5,0"
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="|" />
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="{Binding Target.InputCoordinates.Coordinates.RAString}" />
                                    <TextBlock
                                        Margin="5,0,5,0"
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="|" />
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="{Binding Target.InputCoordinates.Coordinates.DecString}" />
                                    <TextBlock
                                        Margin="5,0,5,0"
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="|" />
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="{Binding Target.Rotation}" />
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Foreground="{StaticResource ButtonForegroundBrush}"
                                        Text="°" />
                                    <StackPanel.Style>
                                        <Style TargetType="StackPanel">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=ninactrl:DetachingExpander}, Path=IsExpanded}" Value="True">
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </StackPanel.Style>
                                </StackPanel>
                            </StackPanel>
                        </ninactrl:DetachingExpander.Header>
                        <Grid>
                            <Grid.Resources>
                                <util:BindingProxy x:Key="nighttimeProxy" Data="{Binding NighttimeData}" />
                            </Grid.Resources>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0" Margin="0,5,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <TextBlock
                                    Width="50"
                                    VerticalAlignment="Center"
                                    Text="{ns:Loc LblName}"
                                    TextWrapping="Wrap" />

                                <ninactrl:HintTextBox
                                    Grid.Row="0"
                                    Grid.Column="1"
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Center"
                                    VerticalContentAlignment="Center"
                                    Foreground="{StaticResource PrimaryBrush}"
                                    HintText="{ns:Loc LblObjectNameHint}"
                                    Text="{Binding Target.TargetName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                            </Grid>

                            <StackPanel
                                Grid.Row="1"
                                Grid.Column="0"
                                Margin="0,5,0,0"
                                DataContext="{Binding Target.InputCoordinates}"
                                Orientation="Horizontal">
                                <TextBlock
                                    Width="50"
                                    VerticalAlignment="Center"
                                    Text="{ns:Loc LblRA}" />
                                <TextBox
                                    Width="40"
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="RAHours" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:HoursRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">h</TextBlock>
                                <TextBox
                                    Width="40"
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="RAMinutes" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:MinutesRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">m</TextBlock>
                                <TextBox
                                    Width="40"
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="RASeconds" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:SecondsRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">s</TextBlock>
                            </StackPanel>
                            <StackPanel
                                Grid.Row="2"
                                Grid.Column="0"
                                Margin="0,5,0,0"
                                VerticalAlignment="Center"
                                DataContext="{Binding Target.InputCoordinates}"
                                Orientation="Horizontal">
                                <TextBlock
                                    Width="50"
                                    VerticalAlignment="Center"
                                    Text="{ns:Loc LblDec}" />
                                <TextBox
                                    Width="40"
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <MultiBinding Converter="{StaticResource DecDegreeConverter}" UpdateSourceTrigger="LostFocus">
                                            <Binding Path="NegativeDec" />
                                            <Binding Path="DecDegrees">
                                                <Binding.ValidationRules>
                                                    <rules:DegreesRule />
                                                </Binding.ValidationRules>
                                            </Binding>
                                        </MultiBinding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">d</TextBlock>
                                <TextBox
                                    Width="40"
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="DecMinutes" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:MinutesRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">m</TextBlock>
                                <TextBox
                                    Width="40"
                                    Margin="5,0,0,0"
                                    VerticalAlignment="Center"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="DecSeconds" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:SecondsRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">s</TextBlock>
                            </StackPanel>
                            <StackPanel
                                Grid.Row="3"
                                Grid.Column="0"
                                Margin="0,5,0,0"
                                VerticalAlignment="Center"
                                Orientation="Horizontal">
                                <TextBlock
                                    Width="50"
                                    VerticalAlignment="Center"
                                    Text="{ns:Loc LblRotation}" />
                                <TextBox
                                    Width="40"
                                    Margin="5,0,0,0"
                                    DataContext="{Binding Target}"
                                    TextAlignment="Right">
                                    <TextBox.Text>
                                        <Binding Path="Rotation" UpdateSourceTrigger="LostFocus">
                                            <Binding.ValidationRules>
                                                <rules:FullCircleDegreesRule />
                                            </Binding.ValidationRules>
                                        </Binding>
                                    </TextBox.Text>
                                </TextBox>
                                <TextBlock VerticalAlignment="Center">°</TextBlock>
                            </StackPanel>

                            <alt:AltitudeChart
                                Grid.Row="0"
                                Grid.RowSpan="5"
                                Grid.Column="1"
                                MinWidth="400"
                                MinHeight="120"
                                Margin="10,0,0,0"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Stretch"
                                AnnotateAltitudeAxis="False"
                                DataContext="{Binding Target.DeepSkyObject}"
                                NighttimeData="{Binding Source={StaticResource nighttimeProxy}, Path=Data}" />
                        </Grid>
                    </ninactrl:DetachingExpander>
                </Border>
            </view:SequenceContainerView.SequenceContainerContent>
        </view:SequenceContainerView>
    </DataTemplate>

    <DataTemplate x:Key="Assistant.NINAPlugin.Sequencer.AssistantInstructionTemplate_Mini">
        <mini:MiniSequenceItem>
            <mini:MiniSequenceItem.SequenceItemContent>
                <StackPanel Orientation="Horizontal">
                    <TextBox Text="mini placeholder" />
                </StackPanel>
            </mini:MiniSequenceItem.SequenceItemContent>
        </mini:MiniSequenceItem>
    </DataTemplate>
</ResourceDictionary>
